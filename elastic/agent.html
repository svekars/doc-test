
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Elastic Agent &#8212; PyTorch main documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=949a1ff5" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/jit.css?v=8de1ea5d" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=3ccf5357" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom2.css?v=dd3e252d" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=a8da1a53"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=940804e7"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'elastic/agent';</script>
    <script src="../_static/js/star-rating.js?v=8861fcb6"></script>
    <script src="../_static/js/send-feedback.js?v=5646bf45"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="main (2.6.0 )" />
<script type="text/javascript" src="../_static/js/send-feedback.js"></script>
<script type="text/javascript" src="../_static/js/star-rating.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-TEST12345"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-TEST12345');
    </script>

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
<body data-feedback-url="https://github.com/pytorch/pytorch">
  <div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="" aria-label="PyTorch"></a>

      <div class="main-menu">
        <ul>

          <li class="main-menu-item">
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Learn
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class=dropdown-title>Get Started</span>
                  <p>Run PyTorch locally or get started quickly with one of the supported cloud platforms</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Tutorials</span>
                  <p>Whats new in PyTorch tutorials</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Learn the Basics</span>
                  <p>Familiarize yourself with PyTorch concepts and modules</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">PyTorch Recipes</span>
                  <p>Bite-size, ready-to-deploy PyTorch code examples</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Intro to PyTorch - YouTube Series</span>
                  <p>Master PyTorch basics with our engaging YouTube tutorial series</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Ecosystem
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Tools</span>
                  <p>Learn about the tools and frameworks in the PyTorch Ecosystem</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class=dropdown-title>Community</span>
                  <p>Join the PyTorch developer community to contribute, learn, and get your questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="" target="_blank">
                  <span class=dropdown-title>Forums</span>
                  <p>A place to discuss PyTorch code, issues, install, research</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class=dropdown-title>Developer Resources</span>
                  <p>Find resources and get questions answered</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Contributor Awards - 2024</span>
                  <p>Award winners announced at this year's PyTorch Conference</p>
                </a>
              </div>
            </div>
          </li>

          <li>
          <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Edge
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">About PyTorch Edge</span>
                  <p>Build innovative and privacy-aware AI experiences for edge devices</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">ExecuTorch</span>
                  <p>End-to-end solution for enabling on-device inference capabilities across mobile and edge devices</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">ExecuTorch Docs</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Docs
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">PyTorch</span>
                  <p>Explore the documentation for comprehensive guidance on how to use PyTorch</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">PyTorch Domains</span>
                  <p>Read the PyTorch Domains documentation to learn more about domain-specific libraries</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                Blogs & News
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">PyTorch Blog</span>
                  <p>Catch up on the latest technical news and happenings</p>
                </a>
                 <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Community Blog</span>
                  <p>Stories from the PyTorch ecosystem</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Videos</span>
                  <p>Learn about the latest PyTorch tutorials, new, and more </p>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Community Stories</span>
                  <p>Learn how our community solves real, everyday machine learning problems with PyTorch</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Events</span>
                  <p>Find events, webinars, and podcasts</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Newsletter</span>
                  <p>Stay up-to-date with the latest updates</p>
                </a>
            </div>
          </li>

          <li>
            <div id="resourcesDropdownButton" data-toggle="resources-dropdown" class="resources-dropdown">
              <a class="with-down-arrow">
                About
              </a>
              <div class="resources-dropdown-menu">
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">PyTorch Foundation</span>
                  <p>Learn more about the PyTorch Foundation</p>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Governing Board</span>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Cloud Credit Program</span>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Technical Advisory Council</span>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Staff</span>
                </a>
                <a class="nav-dropdown-item" href="">
                  <span class="dropdown-title">Contact Us</span>
                </a>
              </div>
            </div>
          </li>

          <li class="main-menu-item">
            <div class="no-dropdown">
              <a href="" data-cta="join">
                Become a Member
              </a>
            </div>
          </li>
          <li>
           <div class="main-menu-item">
             <a href="" class="github-icon">
             </a>
           </div>
          </li>
          <!--- TODO: This block adds the search icon to the nav bar. We will enable it later.
          <li>
            <div class="main-menu-item">
             <a href="" class="search-icon">
             </a>
            </div>
          </li>
          --->
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>
  </div>
</div>

  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Home</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../python-api/index.html">
    Python API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/index.html">
    Developer Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://pytorch.org/tutorials/">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/pytorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torch" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../python-api/index.html">
    Python API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../notes/index.html">
    Developer Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://pytorch.org/tutorials/">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://x.com/PyTorch" title="X" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-x-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">X</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/pytorch/pytorch" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/torch" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-custom fa-pypi fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Elastic Agent</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item"><div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-value="1">★</span>
        
        <span class="star" data-value="2">★</span>
        
        <span class="star" data-value="3">★</span>
        
        <span class="star" data-value="4">★</span>
        
        <span class="star" data-value="5">★</span>
        
    </div>
</div></div>
      
    </div>
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-torch.distributed.elastic.agent">
<span id="elastic-agent"></span><h1>Elastic Agent<a class="headerlink" href="#module-torch.distributed.elastic.agent" title="Link to this heading">#</a></h1>
<section id="module-torch.distributed.elastic.agent.server">
<span id="server"></span><h2>Server<a class="headerlink" href="#module-torch.distributed.elastic.agent.server" title="Link to this heading">#</a></h2>
<p>The elastic agent is the control plane of torchelastic.</p>
<p>It is a process that launches and manages underlying worker processes.
The agent is responsible for:</p>
<ol class="arabic simple">
<li><p>Working with distributed torch: the workers are started with all the
necessary information to successfully and trivially call
<code class="docutils literal notranslate"><span class="pre">torch.distributed.init_process_group()</span></code>.</p></li>
<li><p>Fault tolerance: monitors workers and upon detecting worker failures
or unhealthiness, tears down all workers and restarts everyone.</p></li>
<li><p>Elasticity: Reacts to membership changes and restarts workers with the new
members.</p></li>
</ol>
<p>The simplest agents are deployed per node and works with local processes.
A more advanced agent can launch and manage workers remotely. Agents can
be completely decentralized, making decisions based on the workers it manages.
Or can be coordinated, communicating to other agents (that manage workers
in the same job) to make a collective decision.</p>
<p>Below is a diagram of an agent that manages a local group of workers.</p>
<img alt="../_images/agent_diagram.jpg" src="../_images/agent_diagram.jpg" />
</section>
<section id="concepts">
<h2>Concepts<a class="headerlink" href="#concepts" title="Link to this heading">#</a></h2>
<p>This section describes the high-level classes and concepts that
are relevant to understanding the role of the <code class="docutils literal notranslate"><span class="pre">agent</span></code> in torchelastic.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.ElasticAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">ElasticAgent</span></span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#ElasticAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L371"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.ElasticAgent" title="Link to this definition">#</a></dt>
<dd><p>An agent process responsible for managing one or more worker processes.</p>
<p>The worker processes are assumed to be regular distributed PyTorch scripts.
When the worker process is created by the agent, the agent provides the
necessary information for the worker processes to properly initialize
a torch process group.</p>
<p>The exact deployment topology and ratio of agent-to-worker is dependent
on the specific implementation of the agent and the user’s job placement
preferences. For instance, to run a distributed training job on GPU with
8 trainers (one per GPU) one can:</p>
<ol class="arabic simple">
<li><p>Use 8 x single GPU instances, place an agent per instance, managing
1 worker per agent.</p></li>
<li><p>Use 4 x double GPU instances, place an agent per instance, managing
2 workers per agent.</p></li>
<li><p>Use 2 x quad GPU instances, place an agent per instance, managing
4 workers per agent.</p></li>
<li><p>Use 1 x 8 GPU instance, place an agent per instance, managing
8 workers per agent.</p></li>
</ol>
<p>Usage</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">group_result</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
 <span class="k">if</span> <span class="n">group_result</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
   <span class="c1"># workers failed</span>
   <span class="n">failure</span> <span class="o">=</span> <span class="n">group_result</span><span class="o">.</span><span class="n">failures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
   <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;worker 0 failed with exit code : </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">failure</span><span class="o">.</span><span class="n">exit_code</span><span class="p">)</span>
 <span class="k">else</span><span class="p">:</span>
   <span class="k">return</span> <span class="n">group_result</span><span class="o">.</span><span class="n">return_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># return rank 0&#39;s results</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.ElasticAgent.get_worker_group">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_worker_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">role</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#ElasticAgent.get_worker_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L421"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.ElasticAgent.get_worker_group" title="Link to this definition">#</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">WorkerGroup</span></code> for the given <code class="docutils literal notranslate"><span class="pre">role</span></code>.</p>
<p>Note that the worker group is a mutable object and hence in a
multi-threaded/process environment it may change state.
Implementors are encouraged (but not required) to return
a defensive read-only copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#torch.distributed.elastic.agent.server.WorkerGroup" title="torch.distributed.elastic.agent.server.api.WorkerGroup"><em>WorkerGroup</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.ElasticAgent.run">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">role</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#ElasticAgent.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L406"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.ElasticAgent.run" title="Link to this definition">#</a></dt>
<dd><p>Run the agent.</p>
<p>Supports retrying the worker group on failures up to <code class="docutils literal notranslate"><span class="pre">max_restarts</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The result of the execution, containing the return values or
failure details for each worker mapped by the worker’s global rank.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception - any other failures NOT related to worker process</strong> – </p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#torch.distributed.elastic.agent.server.api.RunResult" title="torch.distributed.elastic.agent.server.api.RunResult"><em>RunResult</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.WorkerSpec">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">WorkerSpec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">role</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_world_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdzv_handler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entrypoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_restarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_addr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_addr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#WorkerSpec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L47"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.WorkerSpec" title="Link to this definition">#</a></dt>
<dd><p>Blueprint information about a particular type of worker.</p>
<p>For a given role, there must only exist a single worker spec.
Worker spec is expected to be homogeneous across all nodes (machine),
that is each node runs the same number of workers for a particular spec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>role</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – user-defined role for the workers with this spec</p></li>
<li><p><strong>local_world_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number local workers to run</p></li>
<li><p><strong>fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><em>None</em>) – (deprecated use entrypoint instead)</p></li>
<li><p><strong>entrypoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – worker function or command</p></li>
<li><p><strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>) – arguments to pass to <code class="docutils literal notranslate"><span class="pre">entrypoint</span></code></p></li>
<li><p><strong>rdzv_handler</strong> (<a class="reference internal" href="rendezvous.html#torch.distributed.elastic.rendezvous.RendezvousHandler" title="torch.distributed.elastic.rendezvous.api.RendezvousHandler"><em>RendezvousHandler</em></a>) – handles rdzv for this set of workers</p></li>
<li><p><strong>max_restarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of max retries for the workers</p></li>
<li><p><strong>monitor_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – monitor status of workers every <code class="docutils literal notranslate"><span class="pre">n</span></code> seconds</p></li>
<li><p><strong>master_port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>) – fixed port to run the c10d store on rank 0
if not specified then will chose a random free port</p></li>
<li><p><strong>master_addr</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>) – fixed master_addr to run the c10d store on rank 0
if not specified then will chose hostname on agent rank 0</p></li>
<li><p><strong>redirects</strong> – redirect std streams to a file,
selectively redirect for a particular
local rank by passing a map</p></li>
<li><p><strong>tee</strong> – tees the specified std stream(s) to console + file,
selectively tee for a particular local rank by passing a map,
takes precedence over <code class="docutils literal notranslate"><span class="pre">redirects</span></code> settings.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.WorkerSpec.get_entrypoint_name">
<span class="sig-name descname"><span class="pre">get_entrypoint_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#WorkerSpec.get_entrypoint_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L103"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.WorkerSpec.get_entrypoint_name" title="Link to this definition">#</a></dt>
<dd><p>Get the entry point name.</p>
<p>If the entrypoint is a function (e.g. <code class="docutils literal notranslate"><span class="pre">Callable</span></code>) returns its <code class="docutils literal notranslate"><span class="pre">__qualname__</span></code>
else if the entrypoint is a binary (e.g. <code class="docutils literal notranslate"><span class="pre">str</span></code>), returns the binary name.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.WorkerState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">WorkerState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#WorkerState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L190"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.WorkerState" title="Link to this definition">#</a></dt>
<dd><p>A state of the <code class="docutils literal notranslate"><span class="pre">WorkerGroup</span></code>.</p>
<p>Workers in a worker group change state as a unit. If a single worker
in a worker group fails the entire set is considered failed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>UNKNOWN - agent lost track of worker group state, unrecoverable
INIT - worker group object created not yet started
HEALTHY - workers running and healthy
UNHEALTHY - workers running and unhealthy
STOPPED - workers stopped (interrupted) by the agent
SUCCEEDED - workers finished running (exit 0)
FAILED - workers failed to successfully finish (exit !0)
</pre></div>
</div>
<p>A worker group starts from an initial <code class="docutils literal notranslate"><span class="pre">INIT</span></code> state,
then progresses to <code class="docutils literal notranslate"><span class="pre">HEALTHY</span></code> or <code class="docutils literal notranslate"><span class="pre">UNHEALTHY</span></code> states,
and finally reaches a terminal <code class="docutils literal notranslate"><span class="pre">SUCCEEDED</span></code> or <code class="docutils literal notranslate"><span class="pre">FAILED</span></code> state.</p>
<p>Worker groups can be interrupted and temporarily put into <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> state
by the agent. Workers in <code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> state are scheduled to be restarted
in the near future by the agent. Some examples of workers being put into
<code class="docutils literal notranslate"><span class="pre">STOPPED</span></code> state are:</p>
<ol class="arabic simple">
<li><p>Worker group failure|unhealthy observed</p></li>
<li><p>Membership change detected</p></li>
</ol>
<p>When actions (start, stop, rdzv, retry, etc) on worker group fails
and results in the action being partially applied to the worker group
the state will be <code class="docutils literal notranslate"><span class="pre">UNKNOWN</span></code>. Typically this happens on uncaught/unhandled
exceptions during state change events on the agent. The agent is not
expected to recover worker groups in <code class="docutils literal notranslate"><span class="pre">UNKNOWN</span></code> state and is better off
self terminating and allowing the job manager to retry the node.</p>
<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.WorkerState.is_running">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_running</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#WorkerState.is_running"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.WorkerState.is_running" title="Link to this definition">#</a></dt>
<dd><p>Return the state of the Worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the worker state represents workers still running
(e.g. that the process exists but not necessarily healthy).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.Worker">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">Worker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">role_world_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#Worker"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L116"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.Worker" title="Link to this definition">#</a></dt>
<dd><p>A worker instance.</p>
<p>Contrast this with <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code> that represents the specifications of a
worker. A <code class="docutils literal notranslate"><span class="pre">Worker</span></code> is created from a <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code>. A <code class="docutils literal notranslate"><span class="pre">Worker</span></code> is to
a <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code> as an object is to a class.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">id</span></code> of the worker is interpreted
by the specific implementation of <code class="docutils literal notranslate"><span class="pre">ElasticAgent</span></code>. For a local
agent, it could be the <code class="docutils literal notranslate"><span class="pre">pid</span> <span class="pre">(int)</span></code> of the worker, for a remote
agent it could be encoded as <code class="docutils literal notranslate"><span class="pre">host:port</span> <span class="pre">(string)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>Any</em>) – uniquely identifies a worker (interpreted by the agent)</p></li>
<li><p><strong>local_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – local rank of the worker</p></li>
<li><p><strong>global_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – global rank of the worker</p></li>
<li><p><strong>role_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – rank of the worker across all workers that have the same role</p></li>
<li><p><strong>world_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of workers (globally)</p></li>
<li><p><strong>role_world_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of workers that have the same role</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.WorkerGroup">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">WorkerGroup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#WorkerGroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.WorkerGroup" title="Link to this definition">#</a></dt>
<dd><p>A set of <code class="docutils literal notranslate"><span class="pre">Worker</span></code> instances.</p>
<p>The class defines a set of <code class="docutils literal notranslate"><span class="pre">Worker</span></code> instances for the given <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code> managed by <code class="docutils literal notranslate"><span class="pre">ElasticAgent</span></code>. Whether the worker
group contains cross instance workers or not depends on the implementation of the agent.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</section>
<section id="implementations">
<h2>Implementations<a class="headerlink" href="#implementations" title="Link to this heading">#</a></h2>
<p>Below are the agent implementations provided by torchelastic.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.local_elastic_agent.LocalElasticAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.local_elastic_agent.</span></span><span class="sig-name descname"><span class="pre">LocalElasticAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs_specs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spawn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exit_barrier_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_line_prefix_template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/local_elastic_agent.html#LocalElasticAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/local_elastic_agent.py#L60"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.local_elastic_agent.LocalElasticAgent" title="Link to this definition">#</a></dt>
<dd><p>An implementation of <code class="xref py py-class docutils literal notranslate"><span class="pre">torchelastic.agent.server.ElasticAgent</span></code> that handles host-local workers.</p>
<p>This agent is deployed per host and is configured to spawn <code class="docutils literal notranslate"><span class="pre">n</span></code> workers.
When using GPUs, <code class="docutils literal notranslate"><span class="pre">n</span></code> maps to the number of GPUs available on the host.</p>
<p>The local agent does not communicate to other local agents deployed on
other hosts, even if the workers may communicate inter-host. The worker id
is interpreted to be a local process. The agent starts and stops all worker
processes as a single unit.</p>
<p>The worker function and argument passed to the worker function must be
python multiprocessing compatible. To pass multiprocessing data structures
to the workers you may create the data structure in the same multiprocessing
context as the specified <code class="docutils literal notranslate"><span class="pre">start_method</span></code> and pass it as a function argument.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">exit_barrier_timeout</span></code> specifies the amount of time (in seconds) to wait
for other agents to finish. This acts as a safety net to handle cases where
workers finish at different times, to prevent agents from viewing workers
that finished early as a scale-down event. It is strongly advised that the
user code deal with ensuring that workers are terminated in a synchronous
manner rather than relying on the exit_barrier_timeout.</p>
<p>A named pipe based watchdog can be enabled in <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> if an
environment variable <code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_ENABLE_FILE_TIMER</span></code> with value 1 has
been defined in the <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> process.
Optionally, another environment variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code>
can be set with a unique file name for the named pipe. If the environment
variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code> is not set, <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code>
will internally create a unique file name and set it to the environment
variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code>, and this environment variable will
be propagated to the worker processes to allow them to connect to the same
named pipe that <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> uses.</p>
<p>Logs are written to the specified log directory. Each log line will be by default
prefixed by <code class="docutils literal notranslate"><span class="pre">[${role_name}${local_rank}]:</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">[trainer0]:</span> <span class="pre">foobar</span></code>).
Log prefixes can be customized by passing a <a class="reference external" href="https://docs.python.org/3/library/string.html#template-strings">template string</a> as the
<code class="docutils literal notranslate"><span class="pre">log_line_prefix_template</span></code> argument.
The following macros (identifiers) are substituted at runtime:
<code class="docutils literal notranslate"><span class="pre">${role_name},</span> <span class="pre">${local_rank},</span> <span class="pre">${rank}</span></code>. For example, to prefix each log line with
global rank instead of the local rank, set <code class="docutils literal notranslate"><span class="pre">log_line_prefix_template</span> <span class="pre">=</span> <span class="pre">&quot;[${rank}]:</span></code>.</p>
<p>Example launching function</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">trainer</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="s2">&quot;do train&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">start_method</span><span class="o">=</span><span class="s2">&quot;spawn&quot;</span>
    <span class="n">shared_queue</span><span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="n">start_method</span><span class="p">)</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">WorkerSpec</span><span class="p">(</span>
                <span class="n">role</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">,</span>
                <span class="n">local_world_size</span><span class="o">=</span><span class="n">nproc_per_process</span><span class="p">,</span>
                <span class="n">entrypoint</span><span class="o">=</span><span class="n">trainer</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;foobar&quot;</span><span class="p">,),</span>
                <span class="o">...&lt;</span><span class="n">OTHER_PARAMS</span><span class="o">...&gt;</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">LocalElasticAgent</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">start_method</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">results</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;trainer failed&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;rank 0 return value: </span><span class="si">{</span><span class="n">results</span><span class="o">.</span><span class="n">return_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># prints -&gt; rank 0 return value: do train</span>
</pre></div>
</div>
<p>Example launching binary</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="n">spec</span> <span class="o">=</span> <span class="n">WorkerSpec</span><span class="p">(</span>
                <span class="n">role</span><span class="o">=</span><span class="s2">&quot;trainer&quot;</span><span class="p">,</span>
                <span class="n">local_world_size</span><span class="o">=</span><span class="n">nproc_per_process</span><span class="p">,</span>
                <span class="n">entrypoint</span><span class="o">=</span><span class="s2">&quot;/usr/local/bin/trainer&quot;</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;--trainer-args&quot;</span><span class="p">,</span> <span class="s2">&quot;foobar&quot;</span><span class="p">),</span>
                <span class="o">...&lt;</span><span class="n">OTHER_PARAMS</span><span class="o">...&gt;</span><span class="p">)</span>
    <span class="n">agent</span> <span class="o">=</span> <span class="n">LocalElasticAgent</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">results</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;binary launches do not have return values&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
</dl>
</dd></dl>

</section>
<section id="extending-the-agent">
<h2>Extending the Agent<a class="headerlink" href="#extending-the-agent" title="Link to this heading">#</a></h2>
<p>To extend the agent you can implement <code class="docutils literal notranslate"><span class="pre">`ElasticAgent</span></code> directly, however
we recommend you extend <code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent</span></code> instead, which provides
most of the scaffolding and leaves you with a few specific abstract methods
to implement.</p>
<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.</span></span><span class="sig-name descname"><span class="pre">SimpleElasticAgent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exit_barrier_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L433"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent" title="Link to this definition">#</a></dt>
<dd><p>An <code class="docutils literal notranslate"><span class="pre">ElasticAgent</span></code> that manages one particular type of worker role.</p>
<p>An <code class="docutils literal notranslate"><span class="pre">ElasticAgent</span></code> that manages workers (<code class="docutils literal notranslate"><span class="pre">WorkerGroup</span></code>) for a single <code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code>
such as one particular type of worker role.</p>
<dl class="field-list simple">
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._assign_worker_ranks">
<span class="sig-name descname"><span class="pre">_assign_worker_ranks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">store</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_world_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._assign_worker_ranks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L554"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._assign_worker_ranks" title="Link to this definition">#</a></dt>
<dd><p>Determine proper ranks for worker processes.</p>
<p>Fast Path: when all workers have the same role and world size. We calculate
the global rank to be group_rank * group_world_size + local_rank. And the
<cite>role_world_size</cite> is the same as <cite>global_world_size</cite>. No TCP store is used in
this case. This is only enabled when users set the environment variable
<cite>TORCH_ELASTIC_WORKER_IDENTICAL</cite> to 1.</p>
<p>Time complexity: each worker O(1), overall O(1)</p>
<p>Slow Path: when workers have different roles and world sizes. We use the
the following algorithm:</p>
<ol class="arabic simple">
<li><p>Each agent writes its configuration(group_rank, group_world_size
, num_workers) to the common store.</p></li>
<li><p>The rank 0 agent reads all the role_info from the store and
determines each agents worker ranks.</p></li>
<li><p>Determine the global rank: the global rank of the workers is computed
by cumulative sum of the local_world_size for all workers in front of it.
For efficiency reasons each worker is assigned a base global rank
such that it’s workers are in the range [base_global_rank,
base_global_rank + local_world_size).</p></li>
<li><p>Determine the role rank: The role rank is determined using the algorithms
in the point 3 with the exception that the ranks are calculated with
respect to the role name.</p></li>
<li><p>The rank 0 agent writes the assigned ranks to the store.</p></li>
<li><p>Each agent reads the assigned ranks from the store.</p></li>
</ol>
<p>Time complexity: each worker O(1), rank0 O(n), overall O(n)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.13)"><em>List</em></a>[<a class="reference internal" href="#torch.distributed.elastic.agent.server.Worker" title="torch.distributed.elastic.agent.server.api.Worker"><em>Worker</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._exit_barrier">
<span class="sig-name descname"><span class="pre">_exit_barrier</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._exit_barrier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L923"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._exit_barrier" title="Link to this definition">#</a></dt>
<dd><p>Define a barrier that keeps the agent process alive until all workers finish.</p>
<p>Wait for <code class="docutils literal notranslate"><span class="pre">exit_barrier_timeout</span></code> seconds for all agents to finish
executing their local workers (either successfully or not). This
acts as a safety guard against user scripts that terminate at different
times.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._initialize_workers">
<span class="sig-name descname"><span class="pre">_initialize_workers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._initialize_workers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L664"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._initialize_workers" title="Link to this definition">#</a></dt>
<dd><p>Start a fresh set of workers for the worker_group.</p>
<p>Essentially, a rendezvous followed by a <code class="docutils literal notranslate"><span class="pre">start_workers</span></code>.
The caller should first call <code class="docutils literal notranslate"><span class="pre">_stop_workers()</span></code> to stop running workers
prior to calling this method.</p>
<p>Optimistically sets the state of the worker group that
just started as <code class="docutils literal notranslate"><span class="pre">HEALTHY</span></code> and delegates the actual monitoring
of state to <code class="docutils literal notranslate"><span class="pre">_monitor_workers()</span></code> method</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._monitor_workers">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_monitor_workers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._monitor_workers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L471"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._monitor_workers" title="Link to this definition">#</a></dt>
<dd><p>Check on the workers for the <code class="docutils literal notranslate"><span class="pre">worker_group</span></code>.</p>
<p>This function also returns the new state of the worker group.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#torch.distributed.elastic.agent.server.api.RunResult" title="torch.distributed.elastic.agent.server.api.RunResult"><em>RunResult</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._rendezvous">
<span class="sig-name descname"><span class="pre">_rendezvous</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._rendezvous"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L490"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._rendezvous" title="Link to this definition">#</a></dt>
<dd><p>Run rendezvous for the workers specified by the worker spec.</p>
<p>Assigns workers a new global rank and world size.
Updates the rendezvous store for the worker group.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._restart_workers">
<span class="sig-name descname"><span class="pre">_restart_workers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._restart_workers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L695"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._restart_workers" title="Link to this definition">#</a></dt>
<dd><p>Restart (stops, rendezvous, starts) all local workers in the group.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._shutdown">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_shutdown</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">death_sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Signals.SIGTERM</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._shutdown"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L479"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._shutdown" title="Link to this definition">#</a></dt>
<dd><p>Clean up any resources that were allocated during the agent’s work.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>death_sig</strong> (<a class="reference external" href="https://docs.python.org/3/library/signal.html#signal.Signals" title="(in Python v3.13)"><em>Signals</em></a>) – Signal to send to the child process, SIGTERM is default</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._start_workers">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_start_workers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._start_workers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L450"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._start_workers" title="Link to this definition">#</a></dt>
<dd><p>Start <code class="docutils literal notranslate"><span class="pre">worker_group.spec.local_world_size</span></code> number of workers.</p>
<p>This is according to worker spec for the worker group .
Returns a map of <code class="docutils literal notranslate"><span class="pre">local_rank</span></code> to worker <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.13)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.13)"><em>Any</em></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.SimpleElasticAgent._stop_workers">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_stop_workers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_restart</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#SimpleElasticAgent._stop_workers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L459"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._stop_workers" title="Link to this definition">#</a></dt>
<dd><p>Stop all workers in the given worker group.</p>
<p>Implementors must deal with workers in all states defined by
<code class="docutils literal notranslate"><span class="pre">WorkerState</span></code>. That is, it must gracefully handle stopping
non-existent workers, unhealthy (stuck) workers, etc.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.api.RunResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.api.</span></span><span class="sig-name descname"><span class="pre">RunResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_values=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">failures=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/api.html#RunResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/api.py#L333"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.api.RunResult" title="Link to this definition">#</a></dt>
<dd><p>Return results of the worker executions.</p>
<p>Run results follow an “all-or-nothing” policy where the run is successful if and
only if ALL local workers managed by this agent complete successfully.</p>
<p>If the result is successful (e.g. <code class="docutils literal notranslate"><span class="pre">is_failed()</span> <span class="pre">=</span> <span class="pre">False</span></code>) then the <code class="docutils literal notranslate"><span class="pre">return_values</span></code>
field contains the outputs (return values) of the workers managed by THIS agent mapped
by their GLOBAL ranks. That is <code class="docutils literal notranslate"><span class="pre">result.return_values[0]</span></code> is the return value of
global rank 0.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">return_values</span></code> are only meaningful for when the worker entrypoint
is a function. Workers specified as a binary entrypoint do not canonically
have a return value and the <code class="docutils literal notranslate"><span class="pre">return_values</span></code> field is meaningless and
may be empty.</p>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">is_failed()</span></code> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> then the <code class="docutils literal notranslate"><span class="pre">failures</span></code> field contains the
failure information, again, mapped by the GLOBAL rank of the worker that failed.</p>
<p>The keys in <code class="docutils literal notranslate"><span class="pre">return_values</span></code> and <code class="docutils literal notranslate"><span class="pre">failures</span></code> are mutually exclusive, that is,
a worker’s final state can only be one of: succeeded, failed. Workers intentionally
terminated by the agent according to the agent’s restart policy, are not represented
in either <code class="docutils literal notranslate"><span class="pre">return_values</span></code> nor <code class="docutils literal notranslate"><span class="pre">failures</span></code>.</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</section>
<section id="watchdog-in-the-agent">
<h2>Watchdog in the Agent<a class="headerlink" href="#watchdog-in-the-agent" title="Link to this heading">#</a></h2>
<p>A named pipe based watchdog can be enabled in <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> if an
environment variable <code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_ENABLE_FILE_TIMER</span></code> with value 1 has
been defined in the <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> process.
Optionally, another environment variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code>
can be set with a unique file name for the named pipe. If the environment
variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code> is not set, <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code>
will internally create a unique file name and set it to the environment
variable <code class="docutils literal notranslate"><span class="pre">`TORCHELASTIC_TIMER_FILE`</span></code>, and this environment variable will
be propagated to the worker processes to allow them to connect to the same
named pipe that <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> uses.</p>
</section>
<section id="health-check-server">
<h2>Health Check Server<a class="headerlink" href="#health-check-server" title="Link to this heading">#</a></h2>
<p>A health check monitoring server can be enabled in <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code>
if an environment variable <code class="docutils literal notranslate"><span class="pre">TORCHELASTIC_HEALTH_CHECK_PORT</span></code> has been defined
in the <code class="docutils literal notranslate"><span class="pre">`LocalElasticAgent`</span></code> process.
Adding interface for health check server which can be extended by starting tcp/http
server on the specified port number.
Additionally, health check server will have callback to check watchdog is alive.</p>
<dl class="py class" id="module-torch.distributed.elastic.agent.server.health_check_server">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.health_check_server.</span></span><span class="sig-name descname"><span class="pre">HealthCheckServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alive_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/health_check_server.html#HealthCheckServer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/health_check_server.py#L19"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer" title="Link to this definition">#</a></dt>
<dd><p>Interface for health check monitoring server, which can be extended
by starting tcp/http server on the specified port.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alive_callback</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em>) – Callable[[], int], callback to last progress time of agent</p></li>
<li><p><strong>port</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – int, port number to start tcp/http server</p></li>
<li><p><strong>timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – int, timeout seconds to decide agent is alive/dead</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/health_check_server.html#HealthCheckServer.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/health_check_server.py#L44"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.start" title="Link to this definition">#</a></dt>
<dd><p>Unsupported functionality for Pytorch, doesn’t start any health check server</p>
<dl class="field-list simple">
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/health_check_server.html#HealthCheckServer.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/health_check_server.py#L50"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.stop" title="Link to this definition">#</a></dt>
<dd><p>Function to stop health check server</p>
<dl class="field-list simple">
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="torch.distributed.elastic.agent.server.health_check_server.create_healthcheck_server">
<span class="sig-prename descclassname"><span class="pre">torch.distributed.elastic.agent.server.health_check_server.</span></span><span class="sig-name descname"><span class="pre">create_healthcheck_server</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alive_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/torch/distributed/elastic/agent/server/health_check_server.html#create_healthcheck_server"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/pytorch/pytorch/blob/2236df1770800ffea5697b11b0bb0d910b2e59e1/torch/distributed/elastic/agent/server/health_check_server.py#L57"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#torch.distributed.elastic.agent.server.health_check_server.create_healthcheck_server" title="Link to this definition">#</a></dt>
<dd><p>creates health check server object</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer" title="torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer"><em>HealthCheckServer</em></a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><div class="feedback">
  <div class="rating">
    Rate this Page
    <div class="stars">
        
        <span class="star" data-value="1">★</span>
        
        <span class="star" data-value="2">★</span>
        
        <span class="star" data-value="3">★</span>
        
        <span class="star" data-value="4">★</span>
        
        <span class="star" data-value="5">★</span>
        
    </div>
</div>
  <div class="feedback-send">
    <button class="feedback-btn" onclick="openGitHubIssue()">Send Feedback</button>
  </div>
</div></div>
  
</div>
                </footer>
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc">
<div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-torch.distributed.elastic.agent.server">Server</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concepts">Concepts</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.ElasticAgent"><code class="docutils literal notranslate"><span class="pre">ElasticAgent</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.ElasticAgent.get_worker_group"><code class="docutils literal notranslate"><span class="pre">ElasticAgent.get_worker_group()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.ElasticAgent.run"><code class="docutils literal notranslate"><span class="pre">ElasticAgent.run()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.WorkerSpec"><code class="docutils literal notranslate"><span class="pre">WorkerSpec</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.WorkerSpec.get_entrypoint_name"><code class="docutils literal notranslate"><span class="pre">WorkerSpec.get_entrypoint_name()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.WorkerState"><code class="docutils literal notranslate"><span class="pre">WorkerState</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.WorkerState.is_running"><code class="docutils literal notranslate"><span class="pre">WorkerState.is_running()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.Worker"><code class="docutils literal notranslate"><span class="pre">Worker</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.WorkerGroup"><code class="docutils literal notranslate"><span class="pre">WorkerGroup</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementations">Implementations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.local_elastic_agent.LocalElasticAgent"><code class="docutils literal notranslate"><span class="pre">LocalElasticAgent</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extending-the-agent">Extending the Agent</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._assign_worker_ranks"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._assign_worker_ranks()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._exit_barrier"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._exit_barrier()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._initialize_workers"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._initialize_workers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._monitor_workers"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._monitor_workers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._rendezvous"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._rendezvous()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._restart_workers"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._restart_workers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._shutdown"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._shutdown()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._start_workers"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._start_workers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.SimpleElasticAgent._stop_workers"><code class="docutils literal notranslate"><span class="pre">SimpleElasticAgent._stop_workers()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.api.RunResult"><code class="docutils literal notranslate"><span class="pre">RunResult</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#watchdog-in-the-agent">Watchdog in the Agent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#health-check-server">Health Check Server</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer"><code class="docutils literal notranslate"><span class="pre">HealthCheckServer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.start"><code class="docutils literal notranslate"><span class="pre">HealthCheckServer.start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.health_check_server.HealthCheckServer.stop"><code class="docutils literal notranslate"><span class="pre">HealthCheckServer.stop()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#torch.distributed.elastic.agent.server.health_check_server.create_healthcheck_server"><code class="docutils literal notranslate"><span class="pre">create_healthcheck_server()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/pytorch/pytorch/edit/main/docs/source/elastic/agent.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
    <div class="tocsection sourcelink">
      <a href="../_sources/elastic/agent.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
      </a>
    </div>
</div>

</div>
<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Community</div>
  <ul>
  
   <li><a class="nav-link nav-external" href="community/index.html">PyTorch Governance</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/docs/stable/community/design.html">PyTorch Design Philosophy</a></li>
  
   <li><a class="nav-link nav-external" href="https://github.com/pytorch/pytorch/wiki/The-Ultimate-Guide-to-PyTorch-Contributions">The Ultimate Guide to PyTorch Contributions</a></li>
  
  </ul>
</div>
<div class="sidebar-secondary-item">
 <div class="sidebar-heading">Language Bindings</div>
 <ul>
 
  <li><a class="nav-link nav-external" href="https://pytorch.org/docs/stable/cpp_index.html">C++</a></li>
 
  <li><a class="nav-link nav-external" href="https://pytorch.org/javadoc/">Javadoc</a></li>
 
  <li><a class="nav-link nav-external" href="https://github.com/pytorch/multipy">torch.multiply</a></li>
 
 </ul>
</div>
<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Libraries</div>
  <ul>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/audio/stable/">torchaudio</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/ao">torchao</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/executorch">ExecuTorch</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/torchrec">torchrec</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/serve/">torchserve</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/data">torchdata</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/data">torchvision</a></li>
  
   <li><a class="nav-link nav-external" href="https://pytorch.org/xla">PyTorch on XLA Devices</a></li>
  
  </ul>
</div>
</div>
</div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright PyTorch Contributors.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>